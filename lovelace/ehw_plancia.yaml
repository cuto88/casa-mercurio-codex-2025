title: "EcoHotWater (EHW)"
views:
  - title: "EHW"
    path: ehw
    icon: mdi:water-boiler
    type: sections
    max_columns: 3

    sections:
      - type: grid
        title: "Temperature"
        cards:
          - type: custom:config-template-card
            variables:
              - states['sensor.ehw_setpoint'].state
            entities:
              - sensor.ehw_setpoint
            card:
              type: gauge
              entity: sensor.ehw_tank_top
              name: Tank top
              unit: "°C"
              min: 20
              max: 70
              severity:
                green: 20
                yellow: ${vars[0]}
                red: 70
          - type: horizontal-stack
            cards:
              - type: entities
                title: "Sonde e delta"
                entities:
                  - entity: sensor.ehw_tank_top
                    name: Tank top
                  - entity: sensor.ehw_tank_bottom
                    name: Tank bottom
                  - type: custom:template-entity-row
                    name: Delta
                    state: >-
                      {{ (states('sensor.ehw_tank_top') | float -
                      states('sensor.ehw_tank_bottom') | float) | round(1) }}
                    unit: "°C"
              - type: entities
                title: "Setpoint"
                entities:
                  - entity: sensor.ehw_setpoint
                    name: Setpoint
          - type: history-graph
            title: "Temperature (24h)"
            hours_to_show: 24
            min_y: 20
            max_y: 80
            entities:
              - entity: sensor.ehw_tank_top
                name: Tank top
              - entity: sensor.ehw_tank_bottom
                name: Tank bottom
              - entity: sensor.ehw_setpoint
                name: Setpoint

      - type: grid
        title: "Calibrazione"
        cards:
          - type: entities
            title: "Calibrazione"
            show_header_toggle: false
            entities:
              - entity: input_number.ehw_temp_scale
                name: Temp scale
              - entity: input_number.ehw_temp_offset
                name: Temp offset
              - entity: input_number.ehw_setpoint_scale
                name: Setpoint scale
              - entity: input_number.ehw_setpoint_offset
                name: Setpoint offset
