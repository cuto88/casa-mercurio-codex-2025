  - binary_sensor:
      - name: "MIRAI status word bit 00"
        unique_id: mirai_status_word_bit_00
        availability: >
          {{ states('sensor.mirai_status_word_raw') not in ['unknown','unavailable','none','None',''] }}
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {{ (v | bitwise_and(2**0)) != 0 }}
      - name: "MIRAI status word bit 01"
        unique_id: mirai_status_word_bit_01
        availability: >
          {{ states('sensor.mirai_status_word_raw') not in ['unknown','unavailable','none','None',''] }}
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {{ (v | bitwise_and(2**1)) != 0 }}
      - name: "MIRAI status word bit 02"
        unique_id: mirai_status_word_bit_02
        availability: >
          {{ states('sensor.mirai_status_word_raw') not in ['unknown','unavailable','none','None',''] }}
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {{ (v | bitwise_and(2**2)) != 0 }}
      - name: "MIRAI status word bit 03"
        unique_id: mirai_status_word_bit_03
        availability: >
          {{ states('sensor.mirai_status_word_raw') not in ['unknown','unavailable','none','None',''] }}
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {{ (v | bitwise_and(2**3)) != 0 }}
      - name: "MIRAI status word bit 04"
        unique_id: mirai_status_word_bit_04
        availability: >
          {{ states('sensor.mirai_status_word_raw') not in ['unknown','unavailable','none','None',''] }}
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {{ (v | bitwise_and(2**4)) != 0 }}
      - name: "MIRAI status word bit 05"
        unique_id: mirai_status_word_bit_05
        availability: >
          {{ states('sensor.mirai_status_word_raw') not in ['unknown','unavailable','none','None',''] }}
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {{ (v | bitwise_and(2**5)) != 0 }}
      - name: "MIRAI status word bit 06"
        unique_id: mirai_status_word_bit_06
        availability: >
          {{ states('sensor.mirai_status_word_raw') not in ['unknown','unavailable','none','None',''] }}
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {{ (v | bitwise_and(2**6)) != 0 }}
      - name: "MIRAI status word bit 07"
        unique_id: mirai_status_word_bit_07
        availability: >
          {{ states('sensor.mirai_status_word_raw') not in ['unknown','unavailable','none','None',''] }}
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {{ (v | bitwise_and(2**7)) != 0 }}
      - name: "MIRAI status word bit 08"
        unique_id: mirai_status_word_bit_08
        availability: >
          {{ states('sensor.mirai_status_word_raw') not in ['unknown','unavailable','none','None',''] }}
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {{ (v | bitwise_and(2**8)) != 0 }}
      - name: "MIRAI status word bit 09"
        unique_id: mirai_status_word_bit_09
        availability: >
          {{ states('sensor.mirai_status_word_raw') not in ['unknown','unavailable','none','None',''] }}
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {{ (v | bitwise_and(2**9)) != 0 }}
      - name: "MIRAI status word bit 10"
        unique_id: mirai_status_word_bit_10
        availability: >
          {{ states('sensor.mirai_status_word_raw') not in ['unknown','unavailable','none','None',''] }}
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {{ (v | bitwise_and(2**10)) != 0 }}
      - name: "MIRAI status word bit 11"
        unique_id: mirai_status_word_bit_11
        availability: >
          {{ states('sensor.mirai_status_word_raw') not in ['unknown','unavailable','none','None',''] }}
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {{ (v | bitwise_and(2**11)) != 0 }}
      - name: "MIRAI status word bit 12"
        unique_id: mirai_status_word_bit_12
        availability: >
          {{ states('sensor.mirai_status_word_raw') not in ['unknown','unavailable','none','None',''] }}
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {{ (v | bitwise_and(2**12)) != 0 }}
      - name: "MIRAI status word bit 13"
        unique_id: mirai_status_word_bit_13
        availability: >
          {{ states('sensor.mirai_status_word_raw') not in ['unknown','unavailable','none','None',''] }}
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {{ (v | bitwise_and(2**13)) != 0 }}
      - name: "MIRAI status word bit 14"
        unique_id: mirai_status_word_bit_14
        availability: >
          {{ states('sensor.mirai_status_word_raw') not in ['unknown','unavailable','none','None',''] }}
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {{ (v | bitwise_and(2**14)) != 0 }}
      - name: "MIRAI status word bit 15"
        unique_id: mirai_status_word_bit_15
        availability: >
          {{ states('sensor.mirai_status_word_raw') not in ['unknown','unavailable','none','None',''] }}
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {{ (v | bitwise_and(2**15)) != 0 }}
  - binary_sensor:
      - name: "MIRAI | Flag bit 03 (TBD)"
        unique_id: mirai_flag_03_tbd
        icon: mdi:flag
        availability: "{{ states('binary_sensor.mirai_status_word_bit_03') not in ['unknown','unavailable'] }}"
        state: "{{ is_state('binary_sensor.mirai_status_word_bit_03','on') }}"
      - name: "MIRAI | Flag bit 07 (TBD)"
        unique_id: mirai_flag_07_tbd
        icon: mdi:flag
        availability: "{{ states('binary_sensor.mirai_status_word_bit_07') not in ['unknown','unavailable'] }}"
        state: "{{ is_state('binary_sensor.mirai_status_word_bit_07','on') }}"
      - name: "MIRAI | Flag bit 08 (TBD)"
        unique_id: mirai_flag_08_tbd
        icon: mdi:flag
        availability: "{{ states('binary_sensor.mirai_status_word_bit_08') not in ['unknown','unavailable'] }}"
        state: "{{ is_state('binary_sensor.mirai_status_word_bit_08','on') }}"
  - sensor:
      - name: "MIRAI status bits ON"
        unique_id: mirai_status_bits_on
        icon: mdi:format-list-bulleted
        state: >
          {% set v = states('sensor.mirai_status_word_raw') | int(0) %}
          {% set bits = [] %}
          {% for i in range(0,16) %}
            {% if (v | bitwise_and(2**i)) != 0 %}
              {% set bits = bits + [i] %}
            {% endif %}
          {% endfor %}
          {{ bits | join(',') }}
  - !include 22_state.yaml
  - !include 23_fault.yaml
