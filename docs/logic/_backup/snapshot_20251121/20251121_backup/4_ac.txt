# =============================================================================
# CONTROLLO AC — CASA SILEA (TV) — PASSIVHAUS-ORIENTED (INDIPENDENTE)
# =============================================================================
# ENTITÀ CONTROLLATE:
#   - switch_ac_giorno  
#   - switch_ac_notte   
#
# PRINCIPI PASSIVHAUS / TARGET:
#   - Comfort target estate: T_in ≈ 26.0 °C e UR_in < 60%
#   - Priorità risparmio/comfort: deumidifica (DRY) prima del raffrescamento, 
#     ma se T_in supera 27.0 °C si passa a COOL.
#
# FASCE:
#   - Giorno  : 07:00–23:00  (AC abilitato)
#   - Notte   : 23:00–07:00  (AC disabilitato: forzare OFF switch_ac_notte e switch_ac_giorno)
#
# TRIGGER CONCETTUALI (linee guida per le automazioni):
#   - Ogni 1 min (time_pattern) + al variare di T_in/UR_in + all’avvio HA.
#
# CONDIZIONI DI ESECUZIONE:
#   A) DRY ON  se:
#        UR_in >= soglia_UR_alta (default 75%)
#        E T_in < 27.0 °C   (sotto soglia COOL)
#      DRY OFF se:
#        UR_in <= UR_target (default 60%)  OPPURE     # isteresi UR
#        T_in   <= 24.0 °C                              
#
#   B) COOL ON se:
#        T_in >= T_cool_on (default 27.0 °C)
#        OPPURE (T_in >= 26.0 °C E UR_in >= 65%)       # caldo + umido
#      COOL OFF se:
#        T_in <= T_target + hyst_T_off  (default: 26.2 °C)  # isteresi T
#
#   C) ARBITRAGGIO:
#      - Se si attiva COOL, ignora DRY (raffrescamento prevale).
#      - Se non serve COOL ma UR è alta → DRY.
#      - Se non serve né COOL né DRY → OFF.
#
# ANTI-CICLO & SICUREZZA:
#   - min_on_minutes  (default 30): una volta acceso, resta ON almeno questo tempo
#   - min_off_minutes (default 30): dopo lo spegnimento, non riaccendere prima di X min
#   - max_run_minutes (default 90): stop forzato e pausa 30 min (anti-ghiaccio/condensa eccessiva)
#   - Ignora decisione se sensori T/UR sono unknown/unavailable.
#
# NOTTE (23:00–07:00):
#   - switch_ac_giorno: OFF forzato
#   - switch_ac_notte : OFF forzato (placeholder per futuri usi Dry notturni)
#
# INTEGRAZIONE (OPZIONALE, MA CONSIGLIATA):
#   - Se VMC è in boost prolungato o in forte free-cooling, l’AC rischia controbilanciamento.
#   - Suggerito: un binary_sensor “ac_blocco_vmc” (SOLO LETTURA) che, se TRUE, impedisce nuovi ON.
#     Manteniamo l’indipendenza: nessuna dipendenza hard; solo condizione opzionale.
#
# NOTE IMPLEMENTATIVE:
#   - Questo blocco fornisce template e soglie helper. Le automazioni di accensione/spegnimento
#     useranno:
#       * binary_sensor.ac_need_dry / ac_need_cool
#       * binary_sensor.ac_lockouts_ok (anti-ciclo)
#       * binary_sensor.ac_should_run (decisione finale)
#   - Le automazioni devono rispettare min_on/min_off/max_run usando last_changed degli switch.
# =============================================================================
