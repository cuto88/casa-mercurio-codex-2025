---
# Step4 naming bridge: canonical cm_* entities mapped to legacy sources.
# Keep legacy entities active for one migration cycle.

template:
  - binary_sensor:
      - name: "CM Contract Actuators Defined"
        unique_id: cm_contract_actuators_defined
        state: "{{ is_state('binary_sensor.contract_actuators_defined','on') }}"

      - name: "CM Contract Surplus Ready"
        unique_id: cm_contract_surplus_ready
        state: "{{ is_state('binary_sensor.contract_surplus_ok_ready','on') }}"

      - name: "CM Policy Allow AC"
        unique_id: cm_policy_allow_ac
        state: "{{ is_state('binary_sensor.policy_allow_ac','on') }}"

      - name: "CM Policy Allow VMC Boost"
        unique_id: cm_policy_allow_vmc_boost
        state: "{{ is_state('binary_sensor.policy_allow_vmc_boost','on') }}"

      - name: "CM Policy Surplus OK"
        unique_id: cm_policy_surplus_ok
        state: "{{ is_state('binary_sensor.policy_surplus_ok','on') }}"

  - sensor:
      - name: "CM Contract Missing Entities"
        unique_id: cm_contract_missing_entities
        state: "{{ states('sensor.contract_missing_entities') }}"

      - name: "CM Policy Reason"
        unique_id: cm_policy_reason
        state: "{{ states('sensor.policy_arbiter_reason') }}"
