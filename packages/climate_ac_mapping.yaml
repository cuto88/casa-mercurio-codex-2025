# Mapping clima AC giorno e notte via SwitchBot (mapping fisico, senza template.climate)

input_number:
  ac_giorno_setpoint:
    name: AC Giorno Setpoint
    min: 16
    max: 30
    step: 1
    unit_of_measurement: "Ãƒâ€šÃ‚Â°C"
    mode: slider
    icon: mdi:air-conditioner
  ac_notte_setpoint:
    name: AC Notte Setpoint
    min: 16
    max: 30
    step: 1
    unit_of_measurement: "Ãƒâ€šÃ‚Â°C"
    mode: slider
    icon: mdi:air-conditioner
  ac_cool_setpoint:
    name: "AC ÃƒÂ¢Ã¢â€šÂ¬Ã¢â‚¬Â setpoint COOL (Ãƒâ€šÃ‚Â°C)"
    min: 22
    max: 28
    step: 0.5
    unit_of_measurement: "Ãƒâ€šÃ‚Â°C"
  ac_dry_ur_on:
    name: "AC ÃƒÂ¢Ã¢â€šÂ¬Ã¢â‚¬Â UR ON (DRY) %"
    min: 50
    max: 80
    step: 1
    unit_of_measurement: "%"
  ac_dry_ur_off:
    name: "AC ÃƒÂ¢Ã¢â€šÂ¬Ã¢â‚¬Â UR OFF (DRY) %"
    min: 40
    max: 75
    step: 1
    unit_of_measurement: "%"
  ac_min_on_minutes:
    name: "AC ÃƒÂ¢Ã¢â€šÂ¬Ã¢â‚¬Â Min ON (min)"
    min: 5
    max: 120
    step: 5
    unit_of_measurement: "min"
  ac_min_off_minutes:
    name: "AC ÃƒÂ¢Ã¢â€šÂ¬Ã¢â‚¬Â Min OFF (min)"
    min: 5
    max: 120
    step: 5
    unit_of_measurement: "min"

input_select:
  ac_giorno_mode:
    name: AC Giorno Mode
    options:
      - off
      - cool
      - heat
      - dry
      - fan_only
      - auto
    icon: mdi:air-conditioner
  ac_notte_mode:
    name: AC Notte Mode
    options:
      - off
      - cool
      - heat
      - dry
      - fan_only
      - auto
    icon: mdi:air-conditioner
  ac_giorno_fan:
    name: AC Giorno Fan
    options:
      - auto
      - low
      - medium
      - high
    icon: mdi:fan
  ac_notte_fan:
    name: AC Notte Fan
    options:
      - auto
      - low
      - medium
      - high
    icon: mdi:fan
  ac_manual_mode:
    name: "AC ÃƒÂ¢Ã¢â€šÂ¬Ã¢â‚¬Â ModalitÃƒÆ’Ã‚Â  manuale"
    options: ["OFF", "DRY", "COOL"]
    icon: mdi:tune-variant

input_boolean:
  ac_manual:
    name: "AC ÃƒÂ¢Ã¢â€šÂ¬Ã¢â‚¬Â Manuale attivo"
    icon: mdi:hand-back-right

  ac_block_vmc:
    name: "AC ÃƒÂ¢Ã¢â€šÂ¬Ã¢â‚¬Â Block da VMC"
    icon: mdi:fan-off

timer:
  ac_manual_timeout:
    name: "AC ÃƒÂ¢Ã¢â€šÂ¬Ã¢â‚¬Â Timeout manuale"
    duration: "01:00:00"

  ac_block_vmc_timeout:
    name: "AC ÃƒÂ¢Ã¢â€šÂ¬Ã¢â‚¬Â Timeout block VMC"
    duration: "00:30:00"

# removed: template.climate is not supported by Home Assistant (see master)

script:
  ac_giorno_apply:
    alias: AC Giorno Apply
    mode: restart
    sequence:
      - choose:
          - conditions: "{{ is_state('switch.ac_giorno', 'off') }}"
            sequence:
              - service: switch.turn_on
                target:
                  entity_id: switch.ac_giorno
      - service: switchbot.send_command
        data:
          device: ac_giorno
          command: setAll
          parameters: >-
            {{ states('input_select.ac_giorno_mode') ~
               ',' ~
               states('input_number.ac_giorno_setpoint') | int ~
               ',' ~
               states('input_select.ac_giorno_fan') }}

  ac_notte_apply:
    alias: AC Notte Apply
    mode: restart
    sequence:
      - choose:
          - conditions: "{{ is_state('switch.ac_notte', 'off') }}"
            sequence:
              - service: switch.turn_on
                target:
                  entity_id: switch.ac_notte
      - service: switchbot.send_command
        data:
          device: ac_notte
          command: setAll
          parameters: >-
            {{ states('input_select.ac_notte_mode') ~
               ',' ~
               states('input_number.ac_notte_setpoint') | int ~
               ',' ~
               states('input_select.ac_notte_fan') }}
