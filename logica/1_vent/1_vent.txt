# 1_vent — Logica ventilazione naturale Casa Mercurio

## Obiettivi
- Suggerire apertura/chiusura serramenti e attivare night-flush estivo per massimizzare il raffrescamento passivo e ridurre l'uso dell'AC.
- Evitare ingressi di umidità, pioggia, vento forte o PM elevato che peggiorerebbero comfort e qualità aria.

## Sensori e attuatori
- Meteo esterno: T_out, UR_out, AH_out, precipitazione, velocità/direzione vento, PM2.5/air_quality.
- Interni: T_in per stanza, UR_in, AH_in; flag finestre aperte per stanza; conteggio finestre aperte.
- Supporto automazioni: input_boolean override estate / night_flush, input_number soglie ΔT/ΔAH/vento/PM, timer lock.
- Attuatori coordinati: notifica consigli, hook verso VMC/AC, eventuali flag serramenti (nessun controllo motorizzato diretto).

## Collegamenti ai core rules
- Logica decisionale completa in `core/regole_core_logiche.md` → sezione "Vent — Ventilazione naturale & night-flush".
- Riferimento a hook `hook_vent_enable_night_flush` per sincronizzare serramenti suggeriti, VMC vel_2 e blocco AC durante flush.

## Eccezioni locali / tuning specifico
- Stagionalità: valido maggio–settembre; in inverno ventilazione demandata a VMC.
- Priorità lato ovest (zone più calde al pomeriggio) per notifiche e suggerimenti, mantenendo ΔT/ΔAH core.
- Soglie iniziali Casa Mercurio: ΔT_min≈1.5 °C, ΔAH_min≈1.0 g/m³, vento_max≈6 m/s; night-flush 21:00–08:00.
- Anti-smog: se PM2.5 o air_quality fuori soglia, sospende suggerimenti di apertura anche con ΔT/ΔAH favorevoli.

## Note di implementazione YAML
- Automazioni e helper in `packages/1_vent.yaml`; nessun controllo YAML qui.
- Binary_sensor `vent_recommend_open/close` e messaggio testo `input_text.vent_messaggio_consiglio` usati da plancia.
- Timer/lock per evitare ping-pong di consigli configurati via `timer.vent_*` e `input_number` soglie.
